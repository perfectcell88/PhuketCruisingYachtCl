<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Phuket Cruising Yacht Club</title>

    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Sail&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />

    <style>
        /* Inline fallback & critical styles */

        /* Reset & base styles */
        body, html {
            margin: 0; padding: 0; height: 100%; /* Keep full height */
            /* REMOVED overflow: hidden; from here, it will be on the main-content-wrapper */
            background: linear-gradient(270deg, #000c1a, #051422, #1a1f36, #0d1321);
            background-size: 800% 800%;
            animation: gradientShift 40s ease infinite;
            font-family: 'Playfair Display', serif;
            color: #f9d976;
            user-select: none;
            text-align: center;
            cursor: url('Anchor.cur'), auto;
        }
        @keyframes gradientShift {
            0%   { background-position: 0% 50%; }
            50%  { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Loading overlay */
        #loading-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            pointer-events: all;
            background: rgba(0,12,26,0.85);
            opacity: 1;
            transition: opacity 1s ease;
        }
        #loading-overlay.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        #loading-overlay::before {
            content: "";
            position: absolute;
            width: 200px; height: 200px;
            background: radial-gradient(circle, rgba(249,217,118,0.1), transparent 70%);
            border-radius: 50%;
            animation: ripple 2.5s ease-out infinite;
            pointer-events: none;
        }
        @keyframes ripple {
            0%   { transform: scale(1);  opacity: 1; }
            100% { transform: scale(2.5); opacity: 0; }
        }

        /* Loading logo and spinner */
        #loading-logo-circle-wrapper {
            position: relative;
            width: 200px;
            height: 200px;
            margin-bottom: 20px;
        }
        #loading-logo {
            width: 200px;
            height: 200px;
            display: block;
            filter: drop-shadow(0 0 8px #f9d976);
            opacity: 0;
            animation: logoPop 0.8s ease-out forwards 0.3s;
            position: relative;
            z-index: 2;
            border-radius: 50%;
        }
        @keyframes logoPop {
            from { opacity: 0; transform: scale(0.8); }
            to   { opacity: 1; transform: scale(1); }
        }
        #loading-circle {
            position: absolute;
            top: 0; left: 0;
            width: 200px;
            height: 200px;
            pointer-events: none;
            z-index: 1;
            animation: spin 1.6s linear infinite;
            filter: drop-shadow(0 0 8px #f9d976);
        }
        #loading-circle.fade-out {
            opacity: 0;
        }
        #loading-circle svg {
            width: 200px;
            height: 200px;
            transform-origin: center;
        }
        @keyframes spin {
            100% { transform: rotate(360deg); }
        }
        #loading-circle circle.base {
            stroke: #333; stroke-width: 12; fill: none; opacity: 0.2;
        }
        #loading-circle circle.progress {
            stroke: #f9d976; stroke-width: 12; fill: none;
            stroke-linecap: round; stroke-dasharray: 283; stroke-dashoffset: 283;
            transition: stroke-dashoffset 0.25s ease;
        }

        /* Specific styles for Captain's Dashboard widgets to ensure they fit */
        /* These were from the old structure, will be overridden by style.css */
         .captain-dashboard {
            display: flex;
            flex-direction: column;
            gap: 20px; /* Space between widgets */
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.3); /* Slightly darker for better contrast */
            border: 1px solid rgba(249, 217, 118, 0.2);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
            margin-top: 40px; /* Add some space from content above */
        }

        .captain-widget {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(249, 217, 118, 0.1);
            text-align: center;
            box-shadow: inset 0 0 5px rgba(249, 217, 118, 0.1);
            color: #fff; /* Ensure text is visible */
        }

        .captain-widget h4 {
            color: #f9d976;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.3em;
            font-weight: 600;
        }

        /* Specific styles for weather widget elements */
        /* These were from the old structure, will be removed from style.css */
        #weather-widget {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .weather-current {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .weather-icon {
            width: 60px; /* Adjusted size */
            height: 60px; /* Adjusted size */
            filter: drop-shadow(0 0 5px rgba(249,217,118,0.5));
        }

        .weather-details {
            display: flex;
            flex-direction: column;
            align-items: flex-start; /* Align text to the left */
        }

        .weather-temp {
            font-size: 2.2em; /* Larger temp */
            font-weight: 700;
            color: #ffe57f;
        }

        .weather-description {
            font-size: 1em;
            text-transform: capitalize;
            color: #ccc;
        }

        .weather-location {
            font-size: 0.9em;
            color: #aaa;
        }

        .weather-info {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-top: 10px;
            color: #ccc;
            font-size: 0.9em;
        }

        .error-message {
            color: #ff6b6b;
            font-weight: bold;
            text-align: center;
        }

        /* Sun & Moon Widget Styles (minimal, as per existing content) */
        /* These were from the old structure, will be removed from style.css */
        #sun-moon-widget {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }
        #sun-moon-widget .time-info {
            font-size: 1.2em;
            color: #ffe57f;
            font-weight: 600;
        }
        #sun-moon-widget .phase-info {
            font-size: 1em;
            color: #ccc;
        }
        #sun-moon-widget .phase-icon {
            font-size: 2em; /* Larger icon for visibility */
            color: #f9d976;
            margin-bottom: 5px;
        }

        /* General glass-widget inherited styles */
        .glass-widget {
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.3); /* Slightly darker for better contrast */
            border: 1px solid rgba(249, 217, 118, 0.2);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
            margin: 20px auto;
            max-width: 800px;
            text-align: center;
        }

        .widget-title {
            color: #f9d976;
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .widget-description {
            color: #ccc;
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div id="fb-root"></div>
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v22.0"></script>

    <div id="loading-overlay" role="alert" aria-live="polite" aria-busy="true">
        <div id="loading-logo-circle-wrapper" aria-hidden="true">
            <img id="loading-logo" src="logob.png" alt="Phuket Cruising Yacht Club Logo" />
            <div id="loading-circle" aria-hidden="true">
                <svg viewBox="0 0 100 100" role="img" aria-hidden="true" >
                    <defs>
                        <linearGradient id="loading-gradient" x1="1" y1="0" x2="0" y2="1">
                            <stop offset="0%" stop-color="#f9d976"/>
                            <stop offset="50%" stop-color="#ffe57f"/>
                            <stop offset="100%" stop-color="#f9d976"/>
                        </linearGradient>
                    </defs>
                    <circle class="base"    cx="50" cy="50" r="45" />
                    <circle class="progress" cx="50" cy="50" r="45" stroke="url(#loading-gradient)"/>
                </svg>
            </div>
        </div>
    </div>

    <div id="threejs-background"></div>

    <div id="page-content" aria-hidden="true">
        <div class="nav-container">
            <nav>
                <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="nav-logo">
                <div class="nav-links">
                    <a href="#home" class="nav-link active">Home</a>
                    <a href="#dashboard" class="nav-link">Dashboard</a>
                    <a href="#services" class="nav-link">Services</a>
                    <a href="#accommodation" class="nav-link">Accommodation</a>
                    <a href="#gallery" class="nav-link">Gallery</a>
                    <a href="#contact" class="nav-link">Contact</a>
                </div>
                <div class="social-icons">
                    <a href="https://www.facebook.com/groups/187918071231247" target="_blank" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                </div>
            </nav>
            <button class="mobile-menu-btn"><i class="fas fa-bars"></i></button>
        </div>

        <div id="main-scrollable-content-wrapper">
            <div class="home-content" id="home">
                <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="main-logo">
                <h1 class="home-title">Phuket Cruising Yacht Club</h1>
                <div class="particles-container" id="particles-container"></div>
                <p style="
    font-family: 'Sail', cursive;
    font-size: 32px;
    font-weight: 600;
    background: linear-gradient(45deg, #004466, #00bcd4);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.4);
    margin-top: 40px;
    animation: fadeIn 2s ease-in-out forwards;
    opacity: 0;
">
    The Islands Premier Yacht Club
                    <br>
</p>
                <div class="intro-text">
                    <p>The fastest growing Yacht Club in Phuket - With a simple mission: to Inform & Entertain you.</p>
                    <p>Enjoy Ice Cold Beer, Great Food & Atmosphere. Meet world cruisers & salty expats.</p>
                    <p>Phuket Cruising Yacht Club - Where our Guests pay the same low prices as Members!</p>
                </div>

                <p><a href="https://www.facebook.com/groups/187918071231247" target="_blank" class="event-link">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/2021_Facebook_icon.svg/800px-2021_Facebook_icon.svg.png" alt="Facebook" class="facebook-logo">
                    Follow us to keep up to date with our Events & Community!
                </a></p>
                <div class="fb-page" data-href="https://www.facebook.com/groups/187918071231247" data-tabs="timeline" data-width="360" data-height="400" data-small-header="true" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"></div>
<div style="height: 80px;"></div>
            </div>

            <section id="dashboard" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="dashboard"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Phuket Maritime Dashboard</h2>
                    <div class="captain-subtitle">Live Weather Alerts, Wind, Sea Conditions, Tides, UV Index & Moon Phases</div>
                    <div class="live-pulse"><div class="live-dot"></div>LIVE</div>

                    <div class="widget-grid">
                        <div class="captain-widget" id="weather-widget">
                            <h4>🌬️ Wind Forecast (Phuket)</h4>
                            <iframe src="https://embed.windy.com/embed2.html?lat=7.880&lon=98.389&zoom=9&level=surface&overlay=wind&menu=&message=&marker=&calendar=now&type=map&location=coordinates&metricWind=kt&metricTemp=°C" frameborder="0" width="100%" height="250"></iframe>
                        </div>

                        <div class="captain-widget">
                            <h4>🌊 Sea Conditions (Phuket)</h4>
                            <iframe src="https://embed.windy.com/embed2.html?lat=7.880&lon=98.389&zoom=9&level=surface&overlay=waves&menu=&message=&marker=&calendar=now&type=map&location=coordinates&metricWind=kt&metricTemp=°C" frameborder="0" width="100%" height="250"></iframe>
                        </div>

                        <div class="captain-widget">
                            <h4>☁️ Cloud & Rain Radar (Phuket)</h4>
                            <iframe src="https://embed.windy.com/embed2.html?lat=7.880&lon=98.389&zoom=9&level=surface&overlay=radar&menu=&message=&marker=&calendar=now&type=map&location=coordinates&metricWind=kt&metricTemp=°C" frameborder="0" width="100%" height="250"></iframe>
                        </div>

                        <div class="captain-widget">
                            <h4>☀️ UV Index (Phuket)</h4>
                            <iframe src="https://www.willyweather.com.au/widget/v2.php?id=30147&sid=88237&style=horizontal&size=medium&days=3&target=uvindex" frameborder="0" width="100%" height="250"></iframe>
                        </div>

                        <div class="captain-widget">
                            <h4>🗓️ Tides (Phuket)</h4>
                            <iframe src="https://www.tides.info/thailand/phuket" frameborder="0" width="100%" height="250"></iframe>
                        </div>

                        <div class="captain-widget" id="sun-moon-widget">
                            <h4>🌕 Sun & Moon Phases</h4>
                            <div id="moon-phase-iframe-container">
                                <iframe src="https://www.moonsy.com/moon-phase-widget.php?size=300&background=transparent&language=en" frameborder="0" scrolling="no" width="100%" height="250"></iframe>
                            </div>
                        </div>

                        <div class="captain-widget">
                            <h4>📡 AIS Marine Traffic</h4>
                            <iframe src="https://www.marinetraffic.com/en/ais/embed/zoom:10/centery:7.880/centerx:98.389/maptype:1/shownames:false/mmsi:0/display_map:true" frameborder="0" width="100%" height="250" scrolling="no"></iframe>
                        </div>

                        <div class="captain-widget">
                            <h4>🚨 Live Earthquake Map</h4>
                            <iframe src="https://www.volcanodiscovery.com/earthquakes/phuket-region.html" frameborder="0" width="100%" height="250"></iframe>
                        </div>

                        <div class="captain-widget">
                            <h4>🕒 Live Local Time</h4>
                            <div id="localTime" style="font-size: 1.8em; font-weight: bold; color: #f9d976; margin-top: 50px;"></div>
                            <div class="warning" style="font-size: 0.9em; margin-top: 10px;">(Automatically refreshes)</div>
                        </div>
                    </div>
                </div>
            </section>
            <section id="club-info" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="club-info"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>About Our Club</h2>
                    <p>The Phuket Cruising Yacht Club, established with a passion for the sea and a love for the vibrant marine life of Phuket, offers a unique haven for both seasoned sailors and aspiring enthusiasts. Our mission is to foster a welcoming community, provide exceptional services, and promote safe and enjoyable cruising experiences in the stunning Andaman Sea. We are dedicated to sharing the beauty of sailing and the camaraderie of the yachting world with our members and guests.</p>
                    <p>Our club is built on principles of friendship, adventure, and mutual respect. We regularly host social gatherings, sailing events, and educational workshops, creating opportunities for members to connect, share experiences, and enhance their maritime skills. Whether you're looking to embark on a grand voyage, learn the ropes, or simply relax by the waterfront with fellow sea lovers, the Phuket Cruising Yacht Club is your perfect destination.</p>
                    <p>Join us to explore the hidden coves, pristine islands, and breathtaking sunsets that make Phuket a world-renowned sailing paradise. Experience great food, ice-cold beer, and the opportunity to meet and chat with world cruisers, salty expats, and enthusiasts.</p>
                    <p>Here at the PCYC, our Guests pay the same low prices as our Members!</p>
                    <p>The PCYC is the island's full service Yacht Club, providing a welcoming atmosphere for sailors and enthusiasts alike.</p>
                </div>
            </section>

            <section id="services" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="services"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Our Services</h2>
                    <p>At Phuket Cruising Yacht Club, we offer a comprehensive range of services to meet all your sailing needs:</p>
                    <ul>
                        <li>Thai Customs Visa Extensions</li>
                        <li>Brokerage</li>
                        <li>Charter</li>
                        <li>Salvage</li>
                        <li>Law Office</li>
                        <li>Second Hand Boat Parts For Sale</li>
                        <li>Boat Minding</li>
                        <li>Rental of Cars, Bikes, RIBs</li>
                        <li>Beach Bungalows</li>
                        <li>Preferred Contractors</li>
                        <li>Mooring Services</li>
                    </ul>
                </div>
            </section>

            <section id="accommodation" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="accommodation"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Accommodation</h2>
                    <p>Experience the beauty of Phuket with our comfortable beach bungalows, perfect for sailors and visitors alike.</p>
                    <div class="accommodation-grid">
                        <div class="bungalow-card">
                            <img src="images/sailboat-414509_1280.jpg" alt="Standard Bungalow" class="bungalow-img">
                            <div class="bungalow-info">
                                <h3 class="bungalow-title">Standard Bungalow</h3>
                                <p class="bungalow-price">From ฿1,500 per night</p>
                                <p class="bungalow-desc">Comfortable beachfront bungalow with all essential amenities, perfect for couples or solo travelers.</p>
                                <a href="#contact" class="book-btn">Inquire Now</a>
                            </div>
                        </div>
                        <div class="bungalow-card">
                            <img src="images/beautiful-woman-yacht-swimwear.jpg" alt="Deluxe Bungalow" class="bungalow-img">
                            <div class="bungalow-info">
                                <h3 class="bungalow-title">Deluxe Bungalow</h3>
                                <p class="bungalow-price">From ฿2,500 per night</p>
                                <p class="bungalow-desc">Spacious bungalow with enhanced amenities and stunning sea views, ideal for families or extended stays.</p>
                                <a href="#contact" class="book-btn">Inquire Now</a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="gallery" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="gallery"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Our Gallery</h2>
                    <p>A glimpse into the vibrant life at Phuket Cruising Yacht Club and the beautiful surroundings of Phuket.</p>
                    <div class="gallery-grid">
                        <img src="images/yacht-1644778_1280.jpg" alt="Luxury Yacht" class="gallery-img">
                        <img src="images/andaman-sea-1481545_1280.jpg" alt="Andaman Sea" class="gallery-img">
                        <img src="images/longtail-boat-1456574_1280.jpg" alt="Longtail Boat" class="gallery-img">
                        <img src="images/phuket-1869502_1280.jpg" alt="Phuket Sunset" class="gallery-img">
                        <img src="images/boat-1327918_1280.jpg" alt="Sailing Boat" class="gallery-img">
                        <img src="images/boat-race-8656687_1280.jpg" alt="Boat Race" class="gallery-img">
                        <img src="images/sea-4712435_1280.jpg" alt="Tropical Sea" class="gallery-img">
                        <img src="images/sailboat-414509_1280.jpg" alt="Sailing in Phuket">
                        <img src="images/75380478_10156391073797175_4972174924367003648_n.jpg" alt="Yacht sailing">
                        <img src="images/463398656_7798563456910157_6872878179612089201_n.jpg" alt="Phuket marina">
                    </div>
                </div>
            </section>

            <section id="contact" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="contact"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Contact Us</h2>
                    <p>We'd love to hear from you! Reach out to us with any inquiries, membership questions, or booking requests.</p>
                    <form id="contact-form" class="contact-form">
                        <div class="form-group">
                            <label for="name">Name</label>
                            <input type="text" id="name" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email</label>
                            <input type="email" id="email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="subject">Subject</label>
                            <input type="text" id="subject" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="message">Message</label>
                            <textarea id="message" class="form-control" rows="5" required></textarea>
                        </div>
                        <button type="submit" class="submit-btn">Send Message</button>
                    </form>
                    <div class="form-success">Your message has been sent successfully! We'll get back to you soon.</div>
                    <p>Connect with us on <a href="https://www.facebook.com/groups/187918071231247" target="_blank" style="color: #f9d976; text-decoration: none;"> <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/2021_Facebook_icon.svg/800px-2021_Facebook_icon.svg.png" alt="Facebook" class="facebook-logo"> Facebook </a> or visit us in person at our club in Phuket.</p>
                </div>
            </section>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/0.150.1/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/js/objects/Water.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.150.1/examples/js/objects/Sky.js"></script>

    <script>
        // Three.js Scene Setup (as provided previously)
        const container = document.getElementById('threejs-background');
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(55, window.innerWidth / window.innerHeight, 1, 20000);
        camera.position.set(30, 30, 100);

        const sun = new THREE.Vector3();

        // Water
        const waterGeometry = new THREE.PlaneGeometry(10000, 10000);
        const water = new THREE.Water(waterGeometry, {
            textureWidth: 512,
            textureHeight: 512,
            waterNormals: new THREE.TextureLoader().load('https://cdn.jsdelivr.net/npm/three@0.150.1/examples/textures/waternormals.jpg', function (texture) {
                texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
            }),
            sunDirection: new THREE.Vector3(),
            sunColor: 0xffffff,
            waterColor: 0x001e0f,
            distortionScale: 3.7,
            fog: false
        });
        water.rotation.x = -Math.PI / 2;
        scene.add(water);

        // Sky
        const sky = new THREE.Sky();
        sky.scale.setScalar(10000);
        scene.add(sky);

        const uni = sky.material.uniforms;
        uni.turbidity.value = 10;
        uni.rayleigh.value = 2;
        uni.mieCoefficient.value = 0.005;
        uni.mieDirectionalG.value = 0.8;

        const phi = THREE.MathUtils.degToRad(90), theta = THREE.MathUtils.degToRad(180);
        sun.setFromSphericalCoords(1, phi, theta);
        uni.sunPosition.value.copy(sun);
        water.material.uniforms.sunDirection.value.copy(sun).normalize();

        // Renderer
        const renderer = new THREE.WebGLRenderer({ antialias: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        container.appendChild(renderer.domElement);

        // Controls
        const controls = new OrbitControls(camera, renderer.domElement);
        controls.maxPolarAngle = Math.PI * 0.495;
        controls.minDistance = 40;
        controls.maxDistance = 200;
        controls.target.copy(sun.clone().multiplyScalar(100));
        controls.update();

        // --- ADDED: Disable zoom controls ---
        controls.enableZoom = false;
        // ------------------------------------

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        const animate = () => {
            requestAnimationFrame(animate);
            water.material.uniforms['time'].value += 1.0 / 60.0;
            renderer.render(scene, camera);
        };
        animate();

        // Loading overlay functionality
        window.addEventListener('load', () => {
            const loadingOverlay = document.getElementById('loading-overlay');
            const loadingCircle = document.getElementById('loading-circle');
            const loadingLogo = document.getElementById('loading-logo');
            const pageContent = document.getElementById('page-content');
            const navContainer = document.querySelector('.nav-container'); // Get the nav-container

            if (loadingOverlay) {
                loadingOverlay.classList.add('fade-out');
                loadingCircle.classList.add('fade-out');
                loadingLogo.classList.add('fade-out');
                setTimeout(() => {
                    loadingOverlay.style.display = 'none';
                    if (pageContent) {
                        pageContent.classList.add('visible');
                    }
                    if (navContainer) { // Make nav-container visible
                        navContainer.classList.add('visible');
                    }
                    document.body.classList.remove('overlay-active'); // Ensure body scroll is re-enabled if it was fixed
                }, 1000); // Matches opacity transition duration
            }
        });

        // Navigation and Content Section Handling
        const navLinkElements = document.querySelectorAll('.nav-link');
        const contentSections = document.querySelectorAll('.content-section');
        const homeContent = document.getElementById('home');
        const mainScrollableContentWrapper = document.getElementById('main-scrollable-content-wrapper');
        const navContainer = document.querySelector('.nav-container');

        navLinkElements.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').substring(1);

                // Toggle 'overlay-active' class on body
                if (targetId === 'home') {
                    document.body.classList.remove('overlay-active');
                    if (homeContent) { // Check if homeContent exists
                        homeContent.classList.add('visible');
                    }
                    contentSections.forEach(section => {
                        section.classList.remove('active');
                    });
                    if (mainScrollableContentWrapper) { // Check if mainScrollableContentWrapper exists
                        mainScrollableContentWrapper.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                } else {
                    document.body.classList.add('overlay-active'); // Disable body scroll
                    // Update active link
                    navLinkElements.forEach(l => l.classList.remove('active'));
                    link.classList.add('active');

                    // Show target section
                    contentSections.forEach(section => {
                        if (section.id === targetId) {
                            section.classList.add('active');
                        } else {
                            section.classList.remove('active');
                        }
                    });

                    if (homeContent) { // Check if homeContent exists
                        homeContent.classList.remove('visible');
                    }

                    const targetSectionElement = document.getElementById(targetId);
                    if (targetSectionElement && mainScrollableContentWrapper) { // Check if both elements exist
                        setTimeout(() => {
                            const navHeight = navContainer ? navContainer.offsetHeight : 0; // Check if navContainer exists
                            // Scroll to the content-container within the target section
                            const contentContainer = targetSectionElement.querySelector('.content-container');
                            if (contentContainer) {
                                // Calculate scroll position to place the top of content-container just below the nav
                                const offsetTop = contentContainer.getBoundingClientRect().top + mainScrollableContentWrapper.scrollTop - navHeight;
                                mainScrollableContentWrapper.scrollTo({ top: offsetTop, behavior: 'smooth' });
                            }
                        }, 100);
                    }
                }
            });
        });

        // Close button functionality
        const closeButtons = document.querySelectorAll('.close-btn');
        closeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const targetSectionId = btn.getAttribute('data-target');
                const targetSectionElement = document.getElementById(targetSectionId);
                if (targetSectionElement) { // Check if targetSectionElement exists
                    targetSectionElement.classList.remove('active');
                }
                if (homeContent) { // Check if homeContent exists
                    homeContent.classList.add('visible');
                }
                document.body.classList.remove('overlay-active'); // Re-enable body scroll
                navLinkElements.forEach(link => link.classList.remove('active'));
                document.querySelector('a[href="#home"]').classList.add('active'); // Set Home as active
                if (mainScrollableContentWrapper) { // Check if mainScrollableContentWrapper exists
                    mainScrollableContentWrapper.scrollTo({ top: 0, behavior: 'smooth' });
                }
            });
        });

        // Contact form submission
        const contactForm = document.getElementById('contact-form');
        const formSuccess = document.querySelector('.form-success');
        if (contactForm && formSuccess) {
            contactForm.addEventListener('submit', function (e) {
                e.preventDefault();
                // In a real application, you would send this data to a server
                // For demonstration, we'll just show a success message
                formSuccess.style.display = 'block';
                contactForm.reset();
                setTimeout(() => {
                    formSuccess.style.display = 'none';
                }, 5000);
            });
        }

        // Mobile menu toggle
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const navLinks = document.querySelector('.nav-links');

        if (mobileMenuBtn && navLinks) {
            mobileMenuBtn.addEventListener('click', () => {
                navLinks.classList.toggle('open');
                mobileMenuBtn.classList.toggle('active'); // Optional: for animating the button
            });
        }

        // Particle effect for home-title
        const particlesContainer = document.getElementById('particles-container');
        const homeTitle = document.querySelector('.home-title');

        if (particlesContainer && homeTitle) {
            // Function to create a single particle
            function createParticle(x, y) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                // Particles are positioned relative to the particles-container
                // particles-container is inside home-content, which is inside main-scrollable-content-wrapper
                // The particles-container is absolutely positioned within home-content
                // So we need to calculate its position relative to the *home-content's* top-left,
                // and home-content's top-left is relative to the *scrollable wrapper's* content area.
                const homeContentRect = homeContent.getBoundingClientRect();
                const relativeX = x - homeContentRect.left + (Math.random() * 40 - 20);
                const relativeY = y - homeContentRect.top + (Math.random() * 20 - 10);
                particle.style.left = `${relativeX}px`;
                particle.style.top = `${relativeY}px`;
                // Random animation delay
                particle.style.animationDelay = `${Math.random() * 3}s`;
                particlesContainer.appendChild(particle);
            }

            // Create initial particles around the title
            function generateInitialParticles() {
                const titleRect = homeTitle.getBoundingClientRect();
                const centerX = titleRect.left + titleRect.width / 2;
                const centerY = titleRect.top + titleRect.height / 2;

                for (let i = 0; i < 50; i++) { // Generate 50 particles initially
                    const angle = Math.random() * Math.PI * 2;
                    const radius = Math.random() * 100; // Spread within 100px radius
                    const x = centerX + radius * Math.cos(angle);
                    const y = centerY + radius * Math.sin(angle);
                    createParticle(x, y);
                }
            }
            generateInitialParticles();
        }

        // Gallery Lightbox
        const galleryImages = document.querySelectorAll('.gallery-img');
        if (galleryImages) {
            galleryImages.forEach(image => {
                image.addEventListener('click', () => {
                    const lightbox = document.createElement('div');
                    lightbox.classList.add('lightbox');

                    const lightboxImg = document.createElement('img');
                    lightboxImg.src = image.src;
                    lightboxImg.alt = image.alt;

                    lightbox.appendChild(lightboxImg);
                    document.body.appendChild(lightbox);

                    // Close lightbox on click
                    lightbox.addEventListener('click', () => {
                        lightbox.remove();
                    });
                });
            });
        }

        // 🕐 Live Local Time Script (Moved from dashboard snippet)
        function updateLocalTime() {
            const now = new Date();
            const options = { timeZone: 'Asia/Bangkok', hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const timeString = now.toLocaleTimeString('en-GB', options);
            const localTimeElement = document.getElementById('localTime');
            if (localTimeElement) { // Ensure element exists before updating
                localTimeElement.textContent = `Current Local Time: ${timeString}`;
            }
        }
        setInterval(updateLocalTime, 1000);
        updateLocalTime(); // Initial call

        // 🔁 Auto-refresh all iframes every 15 minutes (Moved from dashboard snippet)
        setInterval(() => {
            document.querySelectorAll('.captain-widget iframe').forEach(iframe => { // Target only dashboard iframes
                iframe.src = iframe.src;
            });
        }, 15 * 60 * 1000); // 15 minutes

      </script>
</body>
</html>
