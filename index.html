<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Phuket Cruising Yacht Club</title>

    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Sail&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />

    <style>
        /* Inline fallback & critical styles */

        /* Reset & base styles */
        body, html {
            margin: 0; padding: 0; height: 100%; /* Keep full height */
            /* REMOVED overflow: hidden; from here, it will be on the main-content-wrapper */
            background: linear-gradient(270deg, #000c1a, #051422, #1a1f36, #0d1321);
            background-size: 800% 800%;
            animation: gradientShift 40s ease infinite;
            font-family: 'Playfair Display', serif;
            color: #f9d976;
            user-select: none;
            text-align: center;
            cursor: url('Anchor.cur'), auto;
        }
        @keyframes gradientShift {
            0%   { background-position: 0% 50%; }
            50%  { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Loading overlay */
        #loading-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            pointer-events: all;
            background: rgba(0,12,26,0.85);
            opacity: 1;
            transition: opacity 1s ease;
        }
        #loading-overlay.fade-out {
            opacity: 0;
            pointer-events: none;
        }

        #loading-overlay::before {
            content: "";
            position: absolute;
            width: 200px; height: 200px;
            background: radial-gradient(circle, rgba(249,217,118,0.1), transparent 70%);
            border-radius: 50%;
            animation: ripple 2.5s ease-out infinite;
            pointer-events: none;
        }
        @keyframes ripple {
            0%   { transform: scale(1);  opacity: 1; }
            100% { transform: scale(2.5); opacity: 0; }
        }

        /* Loading logo and spinner */
        #loading-logo-circle-wrapper {
            position: relative;
            width: 200px;
            height: 200px;
            margin-bottom: 20px;
        }
        #loading-logo {
            width: 200px;
            height: 200px;
            display: block;
            filter: drop-shadow(0 0 8px #f9d976);
            opacity: 0;
            animation: logoPop 0.8s ease-out forwards 0.3s;
            position: relative;
            z-index: 2;
            border-radius: 50%;
        }
        @keyframes logoPop {
            from { opacity: 0; transform: scale(0.8); }
            to   { opacity: 1; transform: scale(1); }
        }
        #loading-circle {
            position: absolute;
            top: 0; left: 0;
            width: 200px;
            height: 200px;
            pointer-events: none;
            z-index: 1;
            animation: spin 1.6s linear infinite;
            filter: drop-shadow(0 0 8px #f9d976);
        }
        #loading-circle.fade-out {
            opacity: 0;
        }
        #loading-circle svg {
            width: 200px;
            height: 200px;
            transform-origin: center;
        }
        @keyframes spin {
            100% { transform: rotate(360deg); }
        }
        #loading-circle circle.base {
            stroke: #333; stroke-width: 12; fill: none; opacity: 0.2;
        }
        #loading-circle circle.progress {
            stroke: #f9d976; stroke-width: 12; fill: none;
            stroke-linecap: round; stroke-dasharray: 283; stroke-dashoffset: 283;
            transition: stroke-dashoffset 0.25s ease;
        }

        /* Specific styles for Captain's Dashboard widgets to ensure they fit */
        /* These were from the old structure, will be overridden by style.css */
         .captain-dashboard {
            display: flex;
            flex-direction: column;
            gap: 20px; /* Space between widgets */
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.3); /* Slightly darker for better contrast */
            border: 1px solid rgba(249, 217, 118, 0.2);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
            margin-top: 40px; /* Add some space from content above */
        }

        .captain-widget {
            background: rgba(0, 0, 0, 0.4);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(249, 217, 118, 0.1);
            text-align: center;
            box-shadow: inset 0 0 5px rgba(249, 217, 118, 0.1);
            color: #fff; /* Ensure text is visible */
        }

        .captain-widget h4 {
            color: #f9d976;
            margin-top: 0;
            margin-bottom: 10px;
            font-size: 1.3em;
            font-weight: 600;
        }

        /* Specific styles for weather widget elements */
        /* These were from the old structure, will be removed from style.css */
        #weather-widget {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }

        .weather-current {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .weather-icon {
            width: 60px; /* Adjusted size */
            height: 60px; /* Adjusted size */
            filter: drop-shadow(0 0 5px rgba(249,217,118,0.5));
        }

        .weather-details {
            display: flex;
            flex-direction: column;
            align-items: flex-start; /* Align text to the left */
        }

        .weather-temp {
            font-size: 2.2em; /* Larger temp */
            font-weight: 700;
            color: #ffe57f;
        }

        .weather-description {
            font-size: 1em;
            text-transform: capitalize;
            color: #ccc;
        }

        .weather-location {
            font-size: 0.9em;
            color: #aaa;
        }

        .weather-info {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-top: 10px;
            color: #ccc;
            font-size: 0.9em;
        }

        .error-message {
            color: #ff6b6b;
            font-weight: bold;
            text-align: center;
        }

        /* Sun & Moon Widget Styles (minimal, as per existing content) */
        /* These were from the old structure, will be removed from style.css */
        #sun-moon-widget {
            display: flex;
            flex-direction: column;
            gap: 10px;
            align-items: center;
        }
        #sun-moon-widget .time-info {
            font-size: 1.2em;
            color: #ffe57f;
            font-weight: 600;
        }
        #sun-moon-widget .phase-info {
            font-size: 1em;
            color: #ccc;
        }
        #sun-moon-widget .phase-icon {
            font-size: 2em; /* Larger icon for visibility */
            color: #f9d976;
            margin-bottom: 5px;
        }

        /* General glass-widget inherited styles */
        .glass-widget {
            padding: 25px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            background: rgba(0, 0, 0, 0.3); /* Slightly darker for better contrast */
            border: 1px solid rgba(249, 217, 118, 0.2);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.2);
            margin: 20px auto;
            max-width: 800px;
            text-align: center;
        }

        .widget-title {
            color: #f9d976;
            font-size: 2.2em;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .widget-description {
            color: #ccc;
            font-size: 1.1em;
            margin-bottom: 20px;
        }
        @keyframes fadeIn {
            to {
                opacity: 1;
            }
        }
    </style>
</head>
<body>
    <div id="fb-root"></div>
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v22.0"></script>

    <div id="loading-overlay" role="alert" aria-live="polite" aria-busy="true">
        <div id="loading-logo-circle-wrapper" aria-hidden="true">
            <img id="loading-logo" src="logob.png" alt="Phuket Cruising Yacht Club Logo" />
            <div id="loading-circle" aria-hidden="true">
                <svg viewBox="0 0 100 100" role="img" aria-hidden="true" >
                    <defs>
                        <linearGradient id="loading-gradient" x1="1" y1="0" x2="0" y2="1">
                            <stop offset="0%" stop-color="#f9d976"/>
                            <stop offset="50%" stop-color="#ffe57f"/>
                            <stop offset="100%" stop-color="#f9d976"/>
                        </linearGradient>
                    </defs>
                    <circle class="base"    cx="50" cy="50" r="45" />
                    <circle class="progress" cx="50" cy="50" r="45" stroke="url(#loading-gradient)"/>
                </svg>
            </div>
        </div>
    </div>

    <div id="threejs-background"></div>

    <div id="page-content" aria-hidden="true">
        <div id="main-scrollable-content-wrapper">
            <div class="home-content" id="home">
                <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="main-logo">
                <h1 class="home-title">Phuket Cruising Yacht Club</h1>
                <div class="particles-container" id="particles-container"></div>
                <p style="
    font-family: 'Sail', cursive;
    font-size: 36px;
    font-weight: 600;
    background: linear-gradient(45deg, #004466, #00bcd4);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.4);
    margin-top: 40px;
    animation: fadeIn 2s ease-in-out forwards;
    opacity: 0;
">
    Your home base in Phuket
</p>

                <div class="intro-text">
                    <p>The fastest growing Yacht Club in Phuket - With a simple mission: to Inform & Entertain you.</p>
                    <p>Enjoy Ice Cold Beer, Great Food & Atmosphere. Meet world cruisers & salty expats.</p>
                    <p>Phuket Cruising Yacht Club - Where our Guests pay the same low prices as Members!</p>
                </div>

                <p><a href="https://www.facebook.com/groups/187918071231247" target="_blank" class="event-link">
                    <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/2021_Facebook_icon.svg/800px-2021_Facebook_icon.svg.png" alt="Facebook" class="facebook-logo">
                    Follow us to keep up to date with our Events & Community!
                </a></p>
                <div class="fb-page" data-href="https://www.facebook.com/groups/187918071231247" data-tabs="timeline" data-width="360" data-height="400" data-small-header="true" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"></div>
<div style="height: 80px;"></div>
                <style>
    .glass-box {
        background: rgba(255, 255, 255, 0.6);
        backdrop-filter: blur(6px);
        padding: 25px;
        border-radius: 12px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        max-width: 720px;
        margin: 30px auto 15px auto;
        text-align: center;
    }

    .captain-header {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        font-size: 2.4rem;
        font-weight: bold;
        color: #004466;
        text-shadow: 1px 1px 2px rgba(0,0,0,0.15);
        animation: float 2.5s ease-in-out infinite;
    }

    @keyframes float {
        0% { transform: translateY(0); }
        50% { transform: translateY(-3px); }
        100% { transform: translateY(0); }
    }

    .wave-underline {
        width: 200px;
        height: 5px;
        margin: 10px auto 20px;
        background: linear-gradient(90deg, #0077b6, #00b4d8, #0077b6);
        background-size: 300% 100%;
        animation: wave 4s ease-in-out infinite;
        border-radius: 3px;
    }

    @keyframes wave {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
    }

    .captain-subtitle {
        font-size: 1.1rem;
        color: #333;
        margin-bottom: 15px;
        font-style: italic;
    }

    .live-pulse {
        display: inline-flex;
        align-items: center;
        gap: 8px;
        font-weight: 600;
        color: #c60000;
        font-size: 1rem;
        animation: pulseText 2s infinite;
    }

    .live-dot {
        width: 12px;
        height: 12px;
        background-color: #ff0000;
        border-radius: 50%;
        box-shadow: 0 0 6px rgba(255, 0, 0, 0.6);
        animation: pulseDot 1.2s infinite;
    }

    @keyframes pulseDot {
        0% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.4); opacity: 0.6; }
        100% { transform: scale(1); opacity: 1; }
    }

    @keyframes pulseText {
        0%, 100% { opacity: 1; }
        50% { opacity: 0.7; }
    }
</style>

<div class="glass-box">
    <div class="captain-header">- Phuket Maritime Dashboard -</div>
    <div class="wave-underline"></div>
    <div class="captain-subtitle">Live Weather Alerts, Wind, Sea Conditions, Tides, UV Index & Moon Phases</div>
    <div class="live-pulse"><div class="live-dot"></div>LIVE</div>
</div>

<div class="widget-grid">

  <div class="captain-widget">
    <h4>🌬️ Wind Forecast (Phuket)</h4>
    <iframe src="https://embed.windy.com/embed2.html?lat=7.880&lon=98.389&zoom=9&level=surface&overlay=wind&menu=&message=&marker=&calendar=now&type=map&location=coordinates&metricWind=kt&metricTemp=°C" frameborder="0" width="100%" height="250"></iframe>
  </div>

 <div class="captain-widget">
  <h4>🌤️ Weather Forecast (Phuket)</h4>
  <iframe src="https://www.meteoblue.com/en/weather/widget/daily/phuket_thailand_1151254?geoloc=fixed&days=5&tempunit=CELSIUS&windunit=KNOT&layout=image" frameborder="0" scrolling="no" width="100%" height="250"></iframe>
</div>

  <div class="captain-widget">
    <h4>🚨 Weather Alerts (Phuket)</h4>
    <div id="weather-alerts" style="height:250px; overflow-y:auto; padding:10px; box-sizing:border-box; background:#fff;">
      Loading alerts...
    </div>
  </div>

 <div class="captain-widget">
  <h4>🌊 Tide Info (Phuket)</h4>
  <iframe 
    src="https://marea.ooo/en/widget/7.8465199/98.3344152?padding=m&components=text%2Cchart&background=transparent&theme=dark"
    style="background-color: #232629; border: none;"
    width="100%" 
    height="300"
    allow="geolocation"
  ></iframe>
</div>


  <div class="captain-widget">
    <h4>🚢 Live Ship Tracker</h4>
    <iframe src="https://www.marinetraffic.com/en/ais/embed/zoom:10/centery:7.880/centerx:98.389/maptype:1/shownames:false/mmsi:0" frameborder="0" width="100%" height="300"></iframe>
  </div>

  <div class="captain-widget">
  <h4>🌡️ Sea Temperature (Phuket)</h4>
 <iframe 
    src="https://embed.windy.com/embed2.html?lat=7.8804&lon=98.3923&zoom=8&level=surface&overlay=sst&product=analysis&menu=&message=&marker=&calendar=now&type=map&location=coordinates&metricWind=default&metricTemp=default&radarRange=-1"
    style="width: 100%; height: 300px; border:none;"
    frameborder="0"
  ></iframe>
</div>
  <div class="captain-widget">
  <h4>🔆 UV Index (Phuket)</h4>
  <iframe
    src="https://embed.windy.com/embed2.html?lat=7.880&lon=98.389&detailLat=7.880&detailLon=98.389&zoom=9&level=surface&overlay=uv&product=ecmwf&menu=&message=&marker=&calendar=now&type=map&location=coordinates&metricWind=kt&metricTemp=°C"
    width="100%"
    height="300"
    style="border:none;"
    frameborder="0"
  ></iframe>
</div>

<div class="captain-widget" style="text-align:center; width: 300px; margin: 0 auto;">
  <h4>🌕 Moon Phase</h4>
  <!-- MoonConnection.com current moon phase widget -->
  <table cellpadding="0" cellspacing="0" border="0" width="300" style="margin: 0 auto;">
    <tr>
      <td align="center" valign="middle">
        <a href="https://www.moonconnection.com" target="_blank" rel="noopener noreferrer" style="display:inline-block;">
          <img src="https://www.moonmodule.com/cs/dm/hn.gif" width="300" height="185" border="0" alt="Current Moon Phase" />
        </a>
        <div style="position:relative; width: 200px; margin: 10px auto 0;">
          <div style="background:#000; text-align:center; padding: 6px 0; color:#7F7F7F; font-family: Arial, Helvetica, sans-serif; font-size: 13px;">
            <a href="https://www.moonconnection.com/moon_cycle.phtml" target="_blank" rel="noopener noreferrer" style="color:#7F7F7F; text-decoration:none;">
              moon cycle
            </a>
          </div>
        </div>
      </td>
    </tr>
  </table>
  <!-- End moon phase widget -->
</div>

 <div class="captain-widget" style="text-align:center;">
  <h4>🌅 Sunrise & Sunset</h4>
  <iframe
    src="https://dayspedia.com/widgets/digit/?q=Phuket&lang=en&sunrise=1"
    width="100%"
    height="250"
    frameborder="0"
    style="border:none; overflow:hidden;"
    allowtransparency="true"
  ></iframe>
</div>

</div>

<script>
  async function loadWeatherAlerts() {
    try {
      const response = await fetch('/api/phuket-warnings');
      if (!response.ok) throw new Error('Network response was not ok');
      const data = await response.json();

      const container = document.getElementById('weather-alerts');

      if (!data.alerts || data.alerts.length === 0) {
        container.innerHTML = '<p>No current weather alerts for Phuket.</p>';
        return;
      }

      container.innerHTML = data.alerts.map(alert => `
        <div style="border:1px solid #ccc; padding:10px; margin-bottom:10px; background:#fffbe6;">
          <strong>${alert.event}</strong><br>
          <em>From:</em> ${new Date(alert.start * 1000).toLocaleString()}<br>
          <em>To:</em> ${new Date(alert.end * 1000).toLocaleString()}<br>
          <p>${alert.description}</p>
        </div>
      `).join('');

    } catch (error) {
      document.getElementById('weather-alerts').innerText = 'Unable to load alerts.';
      console.error('Fetch error:', error);
    }
  }

  // Call the function on page load
  loadWeatherAlerts();
</script>





            <section id="about" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="about"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>About Us</h2>
                    <p>The fastest growing Yacht Club. Our master plan: Inform & entertain you. It's your home base in Phuket - you're always welcome at the PHUKET CRUISING YACHT CLUB.</p>
                    <p>We also enjoy Ice Cold Beer, Great Food & the opportunity to meet & chat with world cruisers, salty expats & enthusiasts.</p>
                    <p>Here at the PCYC, our Guests pay the same low prices as our Members!</p>
                    <p>The PCYC is the island's full service Yacht Club, providing a welcoming atmosphere for sailors and enthusiasts alike.</p>
                </div>
            </section>

            <section id="services" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="services"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Our Services</h2>
                    <p>At Phuket Cruising Yacht Club, we offer a comprehensive range of services to meet all your sailing needs:</p>
                    <ul>
                        <li>Thai Customs Visa Extensions</li>
                        <li>Brokerage</li>
                        <li>Charter</li>
                        <li>Salvage</li>
                        <li>Law Office</li>
                        <li>Second Hand Boat Parts For Sale</li>
                        <li>Boat Minding</li>
                        <li>Rental of Cars, Bikes, RIBs</li>
                        <li>Beach Bungalows</li>
                        <li>Preferred Contractors</li>
                        <li>Mooring Services</li>
                    </ul>
                </div>
            </section>

            <section id="accommodation" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="accommodation"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Accommodation</h2>
                    <p>Experience the beauty of Phuket with our comfortable beach bungalows, perfect for sailors and visitors alike.</p>

                    <div class="accommodation-grid">
                        <div class="bungalow-card">
                            <img src="images/sailboat-414509_1280.jpg" alt="Standard Bungalow" class="bungalow-img">
                            <div class="bungalow-info">
                                <h3 class="bungalow-title">Standard Bungalow</h3>
                                <p class="bungalow-price">From ฿1,500 per night</p>
                                <p class="bungalow-desc">Comfortable beachfront bungalow with all essential amenities, perfect for couples or solo travelers.</p>
                                <a href="#contact" class="book-btn">Inquire Now</a>
                            </div>
                        </div>

                        <div class="bungalow-card">
                            <img src="images/beautiful-woman-yacht-swimwear.jpg" alt="Deluxe Bungalow" class="bungalow-img">
                            <div class="bungalow-info">
                                <h3 class="bungalow-title">Deluxe Bungalow</h3>
                                <p class="bungalow-price">From ฿2,500 per night</p>
                                <p class="bungalow-desc">Spacious bungalow with premium amenities and stunning ocean views, ideal for extended stays.</p>
                                <a href="#contact" class="book-btn">Inquire Now</a>
                            </div>
                        </div>

                        <div class="bungalow-card">
                            <img src="images/75380478_10156391073797175_4972174924367003648_n.jpg" alt="Family Bungalow" class="bungalow-img">
                            <div class="bungalow-info">
                                <h3 class="bungalow-title">Family Bungalow</h3>
                                <p class="bungalow-price">From ฿3,500 per night</p>
                                <p class="bungalow-desc">Large bungalow with multiple rooms, perfect for families or groups of friends enjoying Phuket together.</p>
                                <a href="#contact" class="book-btn">Inquire Now</a>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="gallery" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="gallery"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Gallery</h2>
                    <p>Explore the beauty of our vibrant community & the Phuket Cruising Yacht Club through our gallery.</p>
                    <div id="gallery-container" class="gallery-grid">
                    </div>
                </div>
            </section>

            <section id="contact" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="contact"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Contact Us</h2>
                    <p>We'd love to hear from you! Whether you're interested in membership, have questions about our services, or just want to learn more about the Phuket Cruising Yacht Club.</p>

                    <div class="contact-form">
                        <form id="contact-form">
                            <div class="form-group">
                                <label for="name">Name</label>
                                <input type="text" id="name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="email">Email</label>
                                <input type="email" id="email" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="subject">Subject</label>
                                <input type="text" id="subject" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="message">Message</label>
                                <textarea id="message" class="form-control" rows="5" required></textarea>
                            </div>
                            <button type="submit" class="submit-btn">Send Message</button>
                        </form>
                        <div class="form-success">Your message has been sent successfully! We'll get back to you soon.</div>
                    </div>
                    <p>Connect with us on <a href="https://www.facebook.com/groups/187918071231247" target="_blank" style="color: #f9d976; text-decoration: none;">
                        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/2021_Facebook_icon.svg/800px-2021_Facebook_icon.svg.png" alt="Facebook" class="facebook-logo">
                        Facebook
                    </a> or visit us in person at our club in Phuket.</p>
                </div>
            </section>
        </div>
    </div>
    <button class="mobile-menu-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="3" y1="12" x2="21" y2="12"></line>
            <line x1="3" y1="6" x2="21" y2="6"></line>
            <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
    </button>

    <div class="nav-container">
        <nav>
            <img src="logob.png" alt="Phuket Cruising Yacht Club" class="nav-logo">
            <div class="nav-links">
                <a href="#home" class="nav-link">HOME</a>
                <a href="#about" class="nav-link">ABOUT</a>
                <a href="#services" class="nav-link">SERVICES</a>
                <a href="#accommodation" class="nav-link">ACCOMMODATION</a>
                <a href="#gallery" class="nav-link">GALLERY</a>
                <a href="#contact" class="nav-link">CONTACT</a>
            </div>
            <a href="https://www.facebook.com/groups/187918071231247" target="_blank" class="social-icon">
                <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/b/b8/2021_Facebook_icon.svg/800px-2021_Facebook_icon.svg.png" alt="Facebook" class="facebook-logo">
            </a>
        </nav>
    </div>
    <script type="module">
        import * as THREE from './js/three.module.js';
        import { OrbitControls } from './js/controls/OrbitControls.js';
        import { Water } from './js/objects/Water.js';
        import { Sky } from './js/objects/Sky.js';

        const overlay = document.getElementById('loading-overlay');
        const prog = document.querySelector('#loading-circle circle.progress');
        const spinner = document.getElementById('loading-circle');
        const pageContent = document.getElementById('page-content'); // This is now the scrollable wrapper
        const mainScrollableContentWrapper = document.getElementById('main-scrollable-content-wrapper'); // New ID for content
        const navContainer = document.querySelector('.nav-container');
        const homeContent = document.querySelector('.home-content');
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        // IMPORTANT: In your script.js you sent earlier, this variable was named navLinksContainer.
        // I am correcting it here to match the variable name used throughout the script.js file.
        const navLinksContainer = document.querySelector('.nav-links'); // Corrected variable name
        let progress = 0;

        // Mobile menu toggle
        // Added checks for existence before adding event listener
        if (mobileMenuBtn && navLinksContainer) { // Check if both elements exist
            mobileMenuBtn.addEventListener('click', () => {
                navLinksContainer.classList.toggle('open');
            });
        }

        // Handle navigation
        const navLinkElements = document.querySelectorAll('.nav-link');
        const contentSections = document.querySelectorAll('.content-section');

        navLinkElements.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('href').substring(1);

                if (navLinksContainer) { // Check if navLinksContainer exists
                    navLinksContainer.classList.remove('open');
                }

                // If clicking HOME, show home content and hide all sections
                if (targetId === 'home') {
                    if (homeContent) { // Check if homeContent exists
                        homeContent.classList.add('visible');
                    }
                    contentSections.forEach(section => {
                        section.classList.remove('active');
                    });
                    if (mainScrollableContentWrapper) { // Check if mainScrollableContentWrapper exists
                        mainScrollableContentWrapper.scrollTo({
                            top: 0,
                            behavior: 'smooth'
                        });
                    }
                } else {
                    // Update active link
                    navLinkElements.forEach(l => l.classList.remove('active'));
                    link.classList.add('active');

                    // Show target section
                    contentSections.forEach(section => {
                        if (section.id === targetId) {
                            section.classList.add('active');
                        } else {
                            section.classList.remove('active');
                        }
                    });
                    if (homeContent) { // Check if homeContent exists
                        homeContent.classList.remove('visible');
                    }

                    const targetSectionElement = document.getElementById(targetId);
                    if (targetSectionElement && mainScrollableContentWrapper) { // Check if both elements exist
                        setTimeout(() => {
                            const navHeight = navContainer ? navContainer.offsetHeight : 0; // Check if navContainer exists
                            mainScrollableContentWrapper.scrollTo({
                                top: targetSectionElement.offsetTop - navHeight,
                                behavior: 'smooth'
                            });
                        }, 100);
                    }
                }
            });
        });

        // Close button functionality
        const closeButtons = document.querySelectorAll('.close-btn');
        closeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const targetSectionId = btn.getAttribute('data-target');
                const targetSectionElement = document.getElementById(targetSectionId);

                if (targetSectionElement) { // Check if targetSectionElement exists
                    targetSectionElement.classList.remove('active');
                }

                if (homeContent) { // Check if homeContent exists
                    homeContent.classList.add('visible');
                }

                navLinkElements.forEach(link => link.classList.remove('active'));

                if (mainScrollableContentWrapper) { // Check if mainScrollableContentWrapper exists
                    mainScrollableContentWrapper.scrollTo({
                        top: 0,
                        behavior: 'smooth'
                    });
                }
            });
        });

        // Contact form submission
        const contactForm = document.getElementById('contact-form');
        const formSuccess = document.querySelector('.form-success');

        if (contactForm && formSuccess) { // Check if both elements exist
            contactForm.addEventListener('submit', (e) => {
                e.preventDefault();
                formSuccess.classList.add('visible');
                contactForm.reset();
                setTimeout(() => {
                    formSuccess.classList.remove('visible');
                }, 5000);
            });
        }
        // Create enhanced water particles effect specifically around the title text
        function createWaterParticles() {
            const particlesContainer = document.getElementById('particles-container');
            const titleElement = document.querySelector('.home-title');

            // Add checks for existence for these elements
            if (!particlesContainer || !titleElement || !homeContent || !mainScrollableContentWrapper) {
                console.warn("Missing elements for water particles. Aborting createWaterParticles.");
                return;
            }

            // Clear existing particles
            particlesContainer.innerHTML = '';

            // Get title position and dimensions relative to the viewport
            const titleRect = titleElement.getBoundingClientRect();

            // Get the scroll position of the main-scrollable-content-wrapper
            const wrapperScrollTop = mainScrollableContentWrapper.scrollTop;
            const wrapperRect = mainScrollableContentWrapper.getBoundingClientRect();

            // Create particles around title text (more concentrated)
            for (let i = 0; i < 40; i++) {
                const particle = document.createElement('div');
                particle.classList.add('water-particle');

                // Calculate absolute position relative to the document
                const absoluteX = titleRect.left + Math.random() * titleRect.width - 10;
                const absoluteY = titleRect.top + Math.random() * titleRect.height - 5;

                // Convert to position relative to the particles-container, accounting for its offset
                // particles-container is inside home-content, which is inside main-scrollable-content-wrapper
                // The particles-container is absolutely positioned within home-content
                // So we need to calculate its position relative to the *home-content's* top-left,
                // and home-content's top-left is relative to the *scrollable wrapper's* content area.
                const homeContentRect = homeContent.getBoundingClientRect();

                const relativeX = absoluteX - homeContentRect.left + (Math.random() * 40 - 20);
                const relativeY = absoluteY - homeContentRect.top + (Math.random() * 20 - 10);


                particle.style.left = `${relativeX}px`;
                particle.style.top = `${relativeY}px`;

                // Random animation delay
                particle.style.animationDelay = `${Math.random() * 3}s`;

                particlesContainer.appendChild(particle);
            }
        }


        // Make all "Inquire Now" buttons redirect to contact form
        document.querySelectorAll('.book-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();

                // Hide all sections
                contentSections.forEach(section => {
                    section.classList.remove('active');
                });

                // Show contact section
                const contactSection = document.getElementById('contact');
                if (contactSection) { // Check if contactSection exists
                    contactSection.classList.add('active');
                }

                // Hide home content
                if (homeContent) { // Check if homeContent exists
                    homeContent.classList.remove('visible');
                }

                // Update active nav link
                navLinkElements.forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === '#contact') {
                        link.classList.add('active');
                    }
                });

                // Scroll to the contact section within the scrollable wrapper
                const contactSectionElement = document.getElementById('contact');
                if (contactSectionElement && mainScrollableContentWrapper && navContainer) { // Check if elements exist
                    setTimeout(() => { // Small delay to allow element to become active/visible
                        const navHeight = navContainer.offsetHeight; // Nav container should exist if nav bar is present
                        mainScrollableContentWrapper.scrollTo({
                            top: contactSectionElement.offsetTop - navHeight,
                            behavior: 'smooth'
                        });
                    }, 100);
                }

                // Focus on subject field and pre-fill with "Accommodation Inquiry"
                setTimeout(() => {
                    const subjectField = document.getElementById('subject'); // Check if subjectField exists
                    if (subjectField) {
                        subjectField.value = "Accommodation Inquiry";
                        subjectField.focus();
                    }
                }, 100);
            });
        });

        function initScene() {
            const threeJsBackground = document.getElementById('threejs-background'); // Get the container
            if (!threeJsBackground) { // Check if container exists
                console.warn("Three.js background container not found. Skipping scene initialization.");
                return;
            }
            const container = document.createElement('div');
            threeJsBackground.appendChild(container); // Append to the background div

            const camera = new THREE.PerspectiveCamera(55, window.innerWidth/window.innerHeight, 1, 20000);
            camera.position.set(30, 30, 100);

            const scene = new THREE.Scene();
            const sun = new THREE.Vector3();

            // Water
            const waterGeom = new THREE.PlaneGeometry(10000, 10000);
            const water = new Water(waterGeom, {
                textureWidth: 512, textureHeight: 512,
                waterNormals: new THREE.TextureLoader().load('textures/waternormals.jpg', tex => {
                    tex.wrapS = tex.wrapT = THREE.RepeatWrapping;
                }),
                sunDirection: new THREE.Vector3(),
                sunColor: 0xffcc66, waterColor: 0x226666,
                distortionScale: 3.7, fog: false
            });
            water.rotation.x = -Math.PI/2;
            scene.add(water);

            // Sky
            const sky = new Sky();
            sky.scale.setScalar(10000);
            scene.add(sky);
            const uni = sky.material.uniforms;
            uni.turbidity.value = 10;
            uni.rayleigh.value = 2;
            uni.mieCoefficient.value = 0.005;
            uni.mieDirectionalG.value = 0.8;

            const phi = THREE.MathUtils.degToRad(90), theta = THREE.MathUtils.degToRad(180);
            sun.setFromSphericalCoords(1, phi, theta);
            uni.sunPosition.value.copy(sun);
            water.material.uniforms.sunDirection.value.copy(sun).normalize();

            // Renderer
            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            container.appendChild(renderer.domElement);

            // Controls
            const controls = new OrbitControls(camera, renderer.domElement);
            controls.maxPolarAngle = Math.PI*0.495;
            controls.minDistance = 40; controls.maxDistance = 200;
            controls.target.copy(sun.clone().multiplyScalar(100));
            controls.update();
            // --- ADDED: Disable zoom controls ---
            controls.enableZoom = false;
            // ------------------------------------

            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth/window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
                // Re-create water particles on resize if home content is visible
                if (homeContent && homeContent.classList.contains('visible')) { // Check if homeContent exists
                    createWaterParticles();
                }
            });

            // Animate
            function animate() {
                requestAnimationFrame(animate);
                water.material.uniforms.time.value += 1/60;
                renderer.render(scene, camera);
            }
            animate();

            // Show navigation and home content after scene is initialized
            setTimeout(() => {
                if (navContainer) navContainer.classList.add('visible'); // Check if navContainer exists
                if (homeContent) { // Check if homeContent exists
                    homeContent.classList.add('visible'); // Keeps home-content visible by default
                    createWaterParticles();
                }
            }, 1000);
        }

        // Simulate loading progress
        const interval = setInterval(() => {
            progress = Math.min(100, progress + Math.random() * 10 + 5);

            const circumference = 2 * Math.PI * 45;
            if (prog) prog.style.strokeDashoffset = circumference * (1 - progress / 100); // Check if prog exists

            if (progress >= 100) {
                clearInterval(interval);

                // Fade out loading overlay
                if (overlay) overlay.classList.add('fade-out'); // Check if overlay exists

                setTimeout(() => {
                    // Remove loading overlay from DOM
                    if (overlay) overlay.remove(); // Check if overlay exists

                    // Initialize Three.js scene
                    initScene();

                    // Reveal page content with fade-in for the *scrollable wrapper*
                    if (pageContent) { // Check if pageContent exists
                        pageContent.setAttribute('aria-hidden', 'false');
                        pageContent.classList.add('visible'); // This now makes the content *wrapper* visible
                    }
                }, 1000); // Match the fade-out duration in CSS
            }
        }, 200);

        // Gallery implementation
        const galleryContainer = document.getElementById('gallery-container'); // Check if galleryContainer exists
        if (galleryContainer) { // Added a check for galleryContainer existence
            const galleryImages = [
                { src: 'images/beautiful-woman-yacht-swimwear.jpg', alt: 'Woman on yacht in Phuket waters' },
                { src: 'images/473599725_10160435212412175_501266893980304214_n.jpg', alt: 'Yacht sailing in Phuket' },
                { src: 'images/148872788_3169037883196037883196094_849598998136454814_n.jpg', alt: 'Yacht Club gathering' },
                { src: 'images/118274592_10157223767507175_1027198816200289080_n.jpg', alt: 'Sailing in Phuket' },
                { src: 'images/75380478_10156391073797175_4972174924367003648_n.jpg', alt: 'Yacht sailing' },
                { src: 'images/463398656_7798563456910157_6872878179612088792_n.jpg', alt: 'Seafood at the yacht club' },
                { src: 'images/468066240_10102904678842276_3997282509366841665_n.jpg', alt: 'Yacht club members' },
                { src: 'images/464508298_8693886117336396_5575655286860524176_n.jpg', alt: 'Sailing yacht' },
                { src: 'images/sailboat-414509_1280.jpg', alt: 'Sailboat at sunset' }
            ];

            // Populate gallery
            galleryImages.forEach(image => {
                const galleryItem = document.createElement('div');
                galleryItem.className = 'gallery-item';

                const img = document.createElement('img');
                img.src = image.src;
                img.alt = image.alt;

                galleryItem.appendChild(img);
                galleryContainer.appendChild(galleryItem);

                // Lightbox functionality
                galleryItem.addEventListener('click', () => {
                    const lightbox = document.createElement('div');
                    lightbox.className = 'lightbox';

                    const lightboxImg = document.createElement('img');
                    lightboxImg.src = image.src;
                    lightboxImg.alt = image.alt;

                    lightbox.appendChild(lightboxImg);
                    document.body.appendChild(lightbox);

                    // Close lightbox on click
                    lightbox.addEventListener('click', () => {
                        lightbox.remove();
                    });
                });
            });
        }

        // 🕐 Live Local Time Script (Moved from dashboard snippet)
        function updateLocalTime() {
            const now = new Date();
            const options = { timeZone: 'Asia/Bangkok', hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const timeString = now.toLocaleTimeString('en-GB', options);
            const localTimeElement = document.getElementById('localTime');
            if (localTimeElement) { // Ensure element exists before updating
                localTimeElement.textContent = `Current Local Time: ${timeString}`;
            }
        }
        setInterval(updateLocalTime, 1000);
        updateLocalTime(); // Initial call

        // 🔁 Auto-refresh all iframes every 15 minutes (Moved from dashboard snippet)
        setInterval(() => {
            document.querySelectorAll('.captain-widget iframe').forEach(iframe => { // Target only dashboard iframes
                iframe.src = iframe.src;
            });
        }, 15 * 60 * 1000); // 15 minutes

      </script>
</body>
</html>
