<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Phuket Cruising Yacht Club</title>

    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css2?family=Sail&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"> <style>
        /* Inline fallback & critical styles */

        /* Reset & base styles */
        body, html {
            margin: 0; padding: 0; height: 100%; /* Keep full height */
            background: linear-gradient(270deg, #000c1a, #051422, #1a1f36, #0d1321); background-size: 800% 800%;
            animation: gradientShift 40s ease infinite;
            font-family: 'Playfair Display', serif;
            color: #f9d976;
            user-select: none;
            text-align: center; cursor: url('Anchor.cur'), auto;
        }
        @keyframes gradientShift {
            0%   { background-position: 0% 50%; }
            50%  { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* Loading overlay */
        #loading-overlay {
            position: fixed; top: 0; left: 0; right: 0; bottom: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            pointer-events: all; background: rgba(0,12,26,0.85);
            opacity: 1;
            transition: opacity 1s ease;
        }
        #loading-overlay.fade-out {
            opacity: 0; pointer-events: none;
        }

        #loading-overlay::before {
            content: ""; position: absolute;
            width: 200px; height: 200px;
            background: radial-gradient(circle, rgba(249,217,118,0.1), transparent 70%);
            border-radius: 50%;
            animation: ripple 2.5s ease-out infinite;
            pointer-events: none;
        }
        @keyframes ripple {
            0%   { transform: scale(1); opacity: 1; }
            100% { transform: scale(2.5); opacity: 0; }
        }

        /* Loading logo and spinner */
        #loading-logo-circle-wrapper {
            position: relative; width: 200px;
            height: 200px;
            margin-bottom: 20px;
        }
        #loading-logo {
            width: 200px; height: 200px;
            display: block;
            filter: drop-shadow(0 0 8px #f9d976);
            opacity: 0;
            animation: logoPop 0.8s ease-out forwards 0.3s;
            position: relative; z-index: 2;
            border-radius: 50%;
        }
        @keyframes logoPop {
            from { opacity: 0; transform: scale(0.8); }
            to   { opacity: 1; transform: scale(1); }
        }
        #loading-circle {
            position: absolute; top: 0; left: 0;
            width: 200px;
            height: 200px;
            pointer-events: none;
            z-index: 1;
            animation: spin 1.6s linear infinite; filter: drop-shadow(0 0 8px #f9d976);
        }
        #loading-circle.fade-out {
            opacity: 0;
        }
        #loading-circle svg {
            width: 200px; height: 200px;
            transform-origin: center;
        }
        @keyframes spin {
            100% { transform: rotate(360deg); }
        }
        #loading-circle circle.base {
            stroke: #333; stroke-width: 12; fill: none; opacity: 0.2;
        }
        #loading-circle circle.progress {
            stroke: #f9d976; stroke-width: 12; fill: none;
            stroke-linecap: round; stroke-dasharray: 283; stroke-dashoffset: 283;
            transition: stroke-dashoffset 0.25s ease;
        }
        @keyframes fadeIn {
            to { opacity: 1; }
        }
    </style>
</head>
<body>
    <div id="fb-root"></div>
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en_US/sdk.js#xfbml=1&version=v22.0"></script>

    <div id="loading-overlay" role="alert" aria-live="polite" aria-busy="true">
        <div id="loading-logo-circle-wrapper" aria-hidden="true">
            <img id="loading-logo" src="logob.png" alt="Phuket Cruising Yacht Club Logo" />
            <div id="loading-circle" aria-hidden="true">
                <svg viewBox="0 0 100 100" role="img" aria-hidden="true">
                    <defs>
                        <linearGradient id="loading-gradient" x1="1" y1="0" x2="0" y2="1">
                            <stop offset="0%" stop-color="#f9d976"/>
                            <stop offset="50%" stop-color="#ffe57f"/>
                            <stop offset="100%" stop-color="#f9d976"/>
                        </linearGradient>
                    </defs>
                    <circle class="base"    cx="50" cy="50" r="45" />
                    <circle class="progress" cx="50" cy="50" r="45" stroke="url(#loading-gradient)"/>
                </svg>
            </div>
        </div>
    </div>

    <div id="threejs-background"></div>

    <div id="page-content" aria-hidden="true">
        <div class="nav-container">
            <nav>
                <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="nav-logo">
                <div class="nav-links">
                    <a href="#home" class="nav-link active" data-target="home">Home</a>
                    <a href="#about" class="nav-link" data-target="about">About Us</a>
                    <a href="#services" class="nav-link" data-target="services">Services</a>
                    <a href="#accommodation" class="nav-link" data-target="accommodation">Accommodation</a>
                    <a href="#gallery" class="nav-link" data-target="gallery">Gallery</a>
                    <a href="#contact" class="nav-link" data-target="contact">Contact</a>
                </div>
                <div class="social-icons">
                    <a href="https://www.facebook.com/groups/187918071231247" target="_blank" aria-label="Facebook"><i class="fab fa-facebook-f social-icon"></i></a>
                    <a href="#" target="_blank" aria-label="WhatsApp"><i class="fab fa-whatsapp social-icon"></i></a>
                    <a href="#" target="_blank" aria-label="Instagram"><i class="fab fa-instagram social-icon"></i></a>
                </div>
            </nav>
        </div>

        <div id="main-scrollable-content-wrapper">

            <div class="home-content" id="home">
                <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="main-logo">
                <h1 class="home-title">Phuket Cruising Yacht Club</h1>
                <div class="particles-container" id="particles-container"></div>
                <p class="home-subtitle">The Islands Premier Yacht Club</p>
                <div class="intro-text">
                    <p>The fastest growing Yacht Club in Phuket - With a simple mission: to Inform & Entertain you.</p>
                    <p>Enjoy Ice Cold Beer, Great Food & Atmosphere. Meet world cruisers & salty expats.</p>
                    <p>Phuket Cruising Yacht Club - Where our Guests pay the same low prices as Members!</p>
                </div>

                <div class="pcyc-section-block" id="about">
                    <h2>Welcome to the PCYC</h2>
                    <p>Nestled in the heart of Phuket's vibrant maritime scene, the Phuket Cruising Yacht Club (PCYC) is more than just a club; it's a thriving community for sailors, cruisers, and maritime enthusiasts. We pride ourselves on being the fastest-growing yacht club on the island, driven by a simple yet powerful mission: to Inform & Entertain you.</p>
                    <p>Whether you're a seasoned world cruiser, a local expat, or just visiting, the PCYC offers a uniquely welcoming atmosphere. Step into our club and experience the camaraderie, enjoy ice-cold beers, and savor delicious food ‚Äì all at the same low prices as our members! We believe in fostering a truly inclusive environment where everyone feels at home.</p>
                    <p>Our roots are deeply embedded in the spirit of adventure and discovery that cruising embodies. We are passionate about promoting safe and enjoyable sailing experiences, sharing local knowledge, and connecting people who share a love for the sea. From lively social gatherings to essential maritime services, the PCYC is designed to support and enrich your life on the water.</p>
                    <p>Join us at the Phuket Cruising Yacht Club ‚Äì your premier destination for all things maritime in Phuket!</p>
                </div>

                <div class="pcyc-section-block" id="services">
                    <h2>Our Services</h2>
                    <p>At Phuket Cruising Yacht Club, we offer a comprehensive range of services to meet all your sailing needs:</p>
                    <ul>
                        <li><i class="fas fa-file-invoice"></i> Thai Customs Visa Extensions</li>
                        <li><i class="fas fa-ship"></i> Brokerage & Charter</li>
                        <li><i class="fas fa-life-ring"></i> Salvage & Emergency Assistance</li>
                        <li><i class="fas fa-gavel"></i> Legal Services & Advice</li>
                        <li><i class="fas fa-wrench"></i> Second Hand Boat Parts & Repairs</li>
                        <li><i class="fas fa-user-shield"></i> Boat Minding & Security</li>
                        <li><i class="fas fa-car"></i> Rental of Cars, Bikes, RIBs</li>
                        <li><i class="fas fa-umbrella-beach"></i> Beach Bungalow Accommodation</li>
                        <li><i class="fas fa-handshake"></i> Preferred Contractors Network</li>
                        <li><i class="fas fa-anchor"></i> Mooring & Berthing Services</li>
                    </ul>
                </div>

                <div class="widgets-container">
                    <div class="glass-box">
                        <div class="captain-header">- Phuket Maritime Dashboard -</div>
                        <div class="wave-underline"></div>
                        <div class="captain-subtitle">Live Weather Alerts, Wind, Sea Conditions, Tides, UV Index & Moon Phases</div>
                        <div class="live-pulse"><div class="live-dot"></div>LIVE</div>
                    </div>
                    <div class="widget-grid">
                        <div class="widget" id="wind-widget">
                            <h4>üå¨Ô∏è Wind Forecast (Phuket)</h4>
                            <iframe
                                src="https://embed.windy.com/embed2.html?lat=7.880&lon=98.389&zoom=9&level=surface&overlay=wind&menu=&message=&marker=&calendar=now&type=map&location=coordinates&metricWind=kt&metricTemp=%C2%B0C"
                                frameborder="0"
                                width="100%"
                                height="250"
                                loading="lazy"
                            ></iframe>
                            <p class="warning">Data provided by Windy.com, use for informational purposes only. Always check local conditions.</p>
                        </div>

                        <div class="widget" id="weather-widget">
                            <h4>‚òÄÔ∏è Local Weather (Phuket)</h4>
                            <div class="weather-current">
                                <img src="" alt="Weather Icon" class="weather-icon">
                                <div class="weather-details">
                                    <span class="weather-temp"></span>
                                    <span class="weather-description"></span>
                                </div>
                            </div>
                            <div class="weather-info">
                                <span>Humidity: <span id="weather-humidity"></span>%</span>
                                <span>Pressure: <span id="weather-pressure"></span> hPa</span>
                            </div>
                            <p class="error-message"></p>
                        </div>

                        <div class="widget" id="tide-widget">
                            <h4>üåä Tide Chart (Phuket)</h4>
                            <iframe
                                src="https://www.tide-forecast.com/locations/Phuket-Island-Thailand/tides/latest/mini?chart=true"
                                frameborder="0"
                                width="100%"
                                height="250"
                                loading="lazy"
                            ></iframe>
                            <p class="warning">Source: Tide-Forecast.com. Consult official navigation charts for critical operations.</p>
                        </div>

                        <div class="widget" id="uv-index-widget">
                            <h4>üîÜ UV Index (Phuket)</h4>
                            <p class="uv-index-value"></p>
                            <p class="uv-index-protection"></p>
                            <p class="warning">Stay safe under the sun! High UV levels can cause rapid sunburn.</p>
                        </div>

                        <div class="widget" id="sun-moon-widget">
                            <h4>üåï Sun & Moon Times (Phuket)</h4>
                            <p><span class="phase-icon"></span><span class="phase-info"></span></p>
                            <p>Sunrise: <span id="sunrise-time" class="time-info"></span></p>
                            <p>Sunset: <span id="sunset-time" class="time-info"></span></p>
                            <p>Moonrise: <span id="moonrise-time" class="time-info"></span></p>
                            <p>Moonset: <span id="moonset-time" class="time-info"></span></p>
                        </div>

                        <div class="widget" id="local-time-widget">
                            <h4>‚è∞ Local Time</h4>
                            <p id="localTime" style="font-size: 1.8em; font-weight: bold; color: #ffe57f;"></p>
                        </div>
                    </div>
                </div>

                <div class="fb-page" data-href="https://www.facebook.com/groups/187918071231247" data-tabs="timeline" data-width="360" data-height="400" data-small-header="true" data-adapt-container-width="true" data-hide-cover="false" data-show-facepile="true"></div>
            </div>

            <section id="accommodation" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="accommodation"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Accommodation</h2>
                    <p>Experience the beauty of Phuket with our comfortable beach bungalows, perfect for sailors and visitors alike. Nestled close to the club, our bungalows offer a tranquil retreat with easy access to all amenities.</p>
                    <div class="accommodation-grid">
                        <div class="bungalow-card">
                            <img src="images/bungalow1.jpg" alt="Standard Bungalow" class="bungalow-img">
                            <div class="bungalow-info">
                                <h3 class="bungalow-title">Standard Bungalow</h3>
                                <p>Cozy and comfortable, ideal for solo travelers or couples.</p>
                                <p class="bungalow-price">‡∏ø800/night</p>
                                <button class="book-btn">Inquire Now</button>
                            </div>
                        </div>
                        <div class="bungalow-card">
                            <img src="images/bungalow2.jpg" alt="Family Bungalow" class="bungalow-img">
                            <div class="bungalow-info">
                                <h3 class="bungalow-title">Family Bungalow</h3>
                                <p>Spacious accommodation for families or small groups.</p>
                                <p class="bungalow-price">‡∏ø1500/night</p>
                                <button class="book-btn">Inquire Now</button>
                            </div>
                        </div>
                        <div class="bungalow-card">
                            <img src="images/bungalow3.jpg" alt="Deluxe Bungalow" class="bungalow-img">
                            <div class="bungalow-info">
                                <h3 class="bungalow-title">Deluxe Bungalow</h3>
                                <p>Premium comfort with enhanced amenities and views.</p>
                                <p class="bungalow-price">‡∏ø2200/night</p>
                                <button class="book-btn">Inquire Now</button>
                            </div>
                        </div>
                    </div>
                    <p class="note">All bungalows include air conditioning, private bathroom, and Wi-Fi. Prices are indicative and subject to change based on season and availability.</p>
                </div>
            </section>

            <section id="gallery" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="gallery"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Gallery</h2>
                    <p>Explore the beauty of Phuket Cruising Yacht Club and the stunning maritime environment.</p>
                    <div class="gallery-grid">
                        <div class="gallery-item">
                            <img src="images/sailboat-414509_1280.jpg" alt="Sailing in Phuket">
                        </div>
                        <div class="gallery-item">
                            <img src="images/75380478_10156391073797175_4972174924367003648_n.jpg" alt="Yacht sailing">
                        </div>
                        <div class="gallery-item">
                            <img src="images/463398656_779313620959143_2725459343753380064_n.jpg" alt="Clubhouse exterior">
                        </div>
                        <div class="gallery-item">
                            <img src="images/463595567_779313600959145_2568603417724391605_n.jpg" alt="Clubhouse interior">
                        </div>
                         <div class="gallery-item">
                            <img src="images/AdobeStock_634458514.jpeg" alt="Phuket Sunset">
                        </div>
                        <div class="gallery-item">
                            <img src="images/AdobeStock_634458514.jpeg" alt="Phuket Beach">
                        </div>
                    </div>
                </div>
            </section>

            <section id="contact" class="content-section">
                <div class="content-container">
                    <div class="close-btn" data-target="contact"></div>
                    <img src="logob.png" alt="Phuket Cruising Yacht Club Logo" class="section-logo">
                    <h2>Contact Us</h2>
                    <p>We'd love to hear from you! Reach out to us for inquiries, bookings, or any assistance you may need.</p>
                    <div class="contact-form-container">
                        <form id="contact-form">
                            <div class="form-group">
                                <label for="name">Name</label>
                                <input type="text" id="name" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="email">Email</label>
                                <input type="email" id="email" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="subject">Subject</label>
                                <input type="text" id="subject" class="form-control" required>
                            </div>
                            <div class="form-group">
                                <label for="message">Message</label>
                                <textarea id="message" class="form-control" rows="5" required></textarea>
                            </div>
                            <button type="submit" class="submit-btn">Send Message</button>
                        </form>
                        <div class="form-success">Your message has been sent successfully! We'll get back to you soon.</div>
                    </div>
                    <p>Connect with us on <a href="https://www.facebook.com/groups/187918071231247" target="_blank" style="color: #f9d976; text-decoration: none;"> <i class="fab fa-facebook-f social-icon"></i> Facebook </a> or visit us in person at our club in Phuket.</p>
                </div>
            </section>

        </div> </div> <button class="mobile-menu-btn">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
    </button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/jsm/objects/Water.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/jsm/objects/Sky.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128.0/examples/jsm/controls/OrbitControls.js"></script>
    <script>
        // DOM Elements
        const loadingOverlay = document.getElementById('loading-overlay');
        const loadingLogo = document.getElementById('loading-logo');
        const loadingCircleProgress = document.querySelector('#loading-circle .progress');
        const loadingCircle = document.getElementById('loading-circle');
        const pageContent = document.getElementById('page-content');
        const navContainer = document.querySelector('.nav-container');
        const navLinkElements = document.querySelectorAll('.nav-link');
        const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
        const homeContent = document.querySelector('.home-content'); // Main scrollable home content
        const contentSections = document.querySelectorAll('.content-section'); // Overlay sections
        const mainScrollableContentWrapper = document.getElementById('main-scrollable-content-wrapper');


        // --- Page Load Animation ---
        window.addEventListener('load', () => {
            let progress = 0;
            const interval = setInterval(() => {
                progress += 5; // Increment by 5%
                if (loadingCircleProgress) {
                    loadingCircleProgress.style.strokeDashoffset = 283 - (283 * progress / 100);
                }
                if (progress >= 100) {
                    clearInterval(interval);
                    if (loadingOverlay) {
                        loadingOverlay.classList.add('fade-out');
                    }
                    if (loadingCircle) {
                        loadingCircle.classList.add('fade-out');
                    }
                    if (loadingLogo) {
                        loadingLogo.style.opacity = '0'; // Ensure logo fades out
                    }
                    // Show page content and nav after a delay
                    setTimeout(() => {
                        if (loadingOverlay) {
                            loadingOverlay.style.display = 'none';
                        }
                        if (pageContent) {
                            pageContent.classList.add('visible');
                            pageContent.setAttribute('aria-hidden', 'false');
                        }
                        if (navContainer) {
                            navContainer.classList.add('visible');
                        }
                        if (homeContent) {
                            homeContent.classList.add('visible'); // Ensure home-content also becomes visible
                        }
                    }, 1000); // Wait for fade-out transition
                }
            }, 50); // Update every 50ms
        });

        // --- Navigation & Section Switching Logic ---
        navLinkElements.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.getAttribute('data-target');

                // Check if the target is within the scrollable home-content or an overlay section
                const isHomeContentSection = ['home', 'about', 'services'].includes(targetId);
                const targetElement = document.getElementById(targetId);

                // Reset active class for all nav links
                navLinkElements.forEach(l => l.classList.remove('active'));
                link.classList.add('active');

                // Handle body overlay class
                if (!isHomeContentSection) {
                    document.body.classList.add('overlay-active');
                    // Hide home content if an overlay is active
                    if (homeContent) {
                        homeContent.classList.remove('visible'); // This will trigger CSS opacity/visibility
                    }
                } else {
                    document.body.classList.remove('overlay-active');
                    // Show home content if navigating to a home-content section
                    if (homeContent) {
                        homeContent.classList.add('visible');
                    }
                }

                // Manage overlay sections visibility
                contentSections.forEach(section => {
                    if (section.id === targetId) {
                        section.classList.add('active');
                    } else {
                        section.classList.remove('active');
                    }
                });

                // Scroll to target within main-scrollable-content-wrapper for home-content sections
                if (isHomeContentSection && targetElement && mainScrollableContentWrapper) {
                     // Hide other overlay sections first to ensure they don't interfere
                    contentSections.forEach(section => section.classList.remove('active'));
                    setTimeout(() => {
                        const navHeight = navContainer ? navContainer.offsetHeight : 0;
                        mainScrollableContentWrapper.scrollTo({ top: targetElement.offsetTop - navHeight, behavior: 'smooth' });
                    }, 100); // Small delay to allow homeContent visibility change
                } else if (!isHomeContentSection && targetElement && mainScrollableContentWrapper) {
                    // For overlay sections, ensure main content is at top when overlay opens (optional, but good for consistency)
                    mainScrollableContentWrapper.scrollTo({ top: 0, behavior: 'auto' });
                }
            });
        });

        // Close button functionality for overlay sections
        const closeButtons = document.querySelectorAll('.close-btn');
        closeButtons.forEach(btn => {
            btn.addEventListener('click', () => {
                const targetSectionId = btn.getAttribute('data-target');
                const targetSectionElement = document.getElementById(targetSectionId);

                if (targetSectionElement) {
                    targetSectionElement.classList.remove('active');
                    document.body.classList.remove('overlay-active');

                    // Activate the 'Home' link in the nav and show home content
                    navLinkElements.forEach(l => l.classList.remove('active'));
                    const homeLink = document.querySelector('.nav-link[data-target="home"]');
                    if (homeLink) {
                        homeLink.classList.add('active');
                    }
                    if (homeContent) {
                        homeContent.classList.add('visible');
                    }
                    // Ensure the main scrollable wrapper is scrolled to top if desired
                    if (mainScrollableContentWrapper) {
                        mainScrollableContentWrapper.scrollTo({ top: 0, behavior: 'smooth' });
                    }
                }
            });
        });

        // Mobile Menu Toggle
        mobileMenuBtn.addEventListener('click', () => {
            if (navContainer) {
                navContainer.classList.toggle('active');
            }
        });

        // Close mobile menu when a link is clicked
        navLinkElements.forEach(link => {
            link.addEventListener('click', () => {
                if (navContainer && navContainer.classList.contains('active')) {
                    navContainer.classList.remove('active');
                }
            });
        });

        // --- Three.js Background ---
        const container = document.getElementById('threejs-background');
        if (container) {
            let camera, scene, renderer, water, sun;
            let currentRotation = 0; // To track camera rotation

            function initThreeJS() {
                // Camera
                camera = new THREE.PerspectiveCamera(55, window.innerWidth / window.innerHeight, 0.5, 3000000);
                camera.position.set(2000, 750, 2000); // Adjusted camera position for better view

                // Scene
                scene = new THREE.Scene();

                // Sun
                sun = new THREE.Vector3();

                // Water
                const waterGeometry = new THREE.PlaneGeometry(10000, 10000); // Larger plane

                water = new THREE.Water(
                    waterGeometry,
                    {
                        textureWidth: 512,
                        textureHeight: 512,
                        waterNormals: new THREE.TextureLoader().load('https://threejs.org/examples/textures/waternormals.jpg', function (texture) {
                            texture.wrapS = texture.wrapT = THREE.RepeatWrapping;
                        }),
                        alpha: 1.0,
                        sunDirection: new THREE.Vector3(),
                        sunColor: 0xffffff,
                        waterColor: 0x001e0f, // Darker water color
                        distortionScale: 3.7,
                        fog: false
                    }
                );
                water.rotation.x = -Math.PI / 2;
                scene.add(water);

                // Sky
                const sky = new Sky();
                sky.scale.setScalar(10000);
                scene.add(sky);

                const uni = sky.material.uniforms;
                uni.turbidity.value = 10;
                uni.rayleigh.value = 2;
                uni.mieCoefficient.value = 0.005;
                uni.mieDirectionalG.value = 0.8;

                const phi = THREE.MathUtils.degToRad(90), theta = THREE.MathUtils.degToRad(180); // Adjusted sun position
                sun.setFromSphericalCoords(1, phi, theta);
                uni.sunPosition.value.copy(sun);
                water.material.uniforms.sunDirection.value.copy(sun).normalize();

                // Renderer
                renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true }); // alpha: true for transparent background
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setClearColor(0x000000, 0); // Transparent clear color
                container.appendChild(renderer.domElement);

                // Controls (Optional, for debugging/testing)
                // const controls = new OrbitControls(camera, renderer.domElement);
                // controls.maxPolarAngle = Math.PI * 0.495;
                // controls.target.set(0, 10, 0);
                // controls.minDistance = 40.0;
                // controls.maxDistance = 200.0;
                // controls.update();

                window.addEventListener('resize', onWindowResize);
            }

            function onWindowResize() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }

            function animateThreeJS() {
                requestAnimationFrame(animateThreeJS);

                // Smoothly rotate the camera around the scene
                currentRotation += 0.00005; // Control speed of rotation
                const radius = 2000; // Distance from the center
                camera.position.x = radius * Math.sin(currentRotation);
                camera.position.z = radius * Math.cos(currentRotation);
                camera.position.y = 750 + 50 * Math.sin(currentRotation * 0.5); // Subtle vertical bobbing

                camera.lookAt(new THREE.Vector3(0, 0, 0)); // Always look at the center

                water.material.uniforms['time'].value += 1.0 / 60.0;
                renderer.render(scene, camera);
            }

            initThreeJS();
            animateThreeJS();
        }

        // --- Dynamic Particle Effect on Main Logo ---
        const particlesContainer = document.getElementById('particles-container');
        if (particlesContainer) {
            const numParticles = 30; // Number of particles

            for (let i = 0; i < numParticles; i++) {
                createParticle();
            }

            function createParticle() {
                const particle = document.createElement('div');
                particle.classList.add('particle');
                particlesContainer.appendChild(particle);

                // Random position within a wider area around the logo
                const x = (Math.random() - 0.5) * 600; // -300 to 300
                const y = (Math.random() - 0.5) * 400; // -200 to 200

                particle.style.left = `${x}px`;
                particle.style.top = `${y}px`;
                particle.style.animationDelay = `${Math.random() * 3}s`; // Random animation delay
            }
        }

        // --- Gallery Lightbox ---
        const galleryItems = document.querySelectorAll('.gallery-item img');
        if (galleryItems.length > 0) { // Only add listener if gallery exists
            galleryItems.forEach(image => {
                image.addEventListener('click', () => {
                    const lightbox = document.createElement('div');
                    lightbox.classList.add('lightbox');

                    const lightboxImg = document.createElement('img');
                    lightboxImg.src = image.src;
                    lightboxImg.alt = image.alt;

                    lightbox.appendChild(lightboxImg);
                    document.body.appendChild(lightbox);

                    // Close lightbox on click
                    lightbox.addEventListener('click', () => {
                        lightbox.remove();
                    });
                });
            });
        }

        // --- Weather Widget Logic (using OpenWeatherMap API) ---
        const WEATHER_API_KEY = 'YOUR_OPENWEATHERMAP_API_KEY'; // Replace with your actual API key
        const weatherWidget = document.getElementById('weather-widget');
        if (weatherWidget && WEATHER_API_KEY !== 'YOUR_OPENWEATHERMAP_API_KEY') {
            const weatherIconElement = weatherWidget.querySelector('.weather-icon');
            const weatherTempElement = weatherWidget.querySelector('.weather-temp');
            const weatherDescriptionElement = weatherWidget.querySelector('.weather-description');
            const weatherHumidityElement = document.getElementById('weather-humidity');
            const weatherPressureElement = document.getElementById('weather-pressure');
            const errorMessageElement = weatherWidget.querySelector('.error-message');

            const fetchWeather = async () => {
                try {
                    // Coordinates for Phuket (e.g., Patong Beach)
                    const lat = 7.89;
                    const lon = 98.29;
                    const url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&units=metric&appid=${WEATHER_API_KEY}`;
                    const response = await fetch(url);
                    const data = await response.json();

                    if (response.ok) {
                        weatherIconElement.src = `https://openweathermap.org/img/wn/${data.weather[0].icon}@2x.png`;
                        weatherTempElement.textContent = `${Math.round(data.main.temp)}¬∞C`;
                        weatherDescriptionElement.textContent = data.weather[0].description;
                        weatherHumidityElement.textContent = data.main.humidity;
                        weatherPressureElement.textContent = data.main.pressure;
                        errorMessageElement.textContent = ''; // Clear any previous errors
                    } else {
                        errorMessageElement.textContent = `Error: ${data.message}`;
                    }
                } catch (error) {
                    console.error('Failed to fetch weather data:', error);
                    errorMessageElement.textContent = 'Failed to load weather data. Please try again later.';
                }
            };
            fetchWeather(); // Initial fetch
            setInterval(fetchWeather, 60 * 60 * 1000); // Refresh every hour
        } else if (weatherWidget && WEATHER_API_KEY === 'YOUR_OPENWEATHERMAP_API_KEY') {
            weatherWidget.querySelector('.error-message').textContent = 'Please replace YOUR_OPENWEATHERMAP_API_KEY with a valid API key for weather data.';
        }

        // --- UV Index Widget Logic ---
        const UV_API_KEY = 'YOUR_OPENWEATHERMAP_API_KEY'; // Re-using OpenWeatherMap API key for UV Index
        const uvIndexWidget = document.getElementById('uv-index-widget');
        if (uvIndexWidget && UV_API_KEY !== 'YOUR_OPENWEATHERMAP_API_KEY') {
            const uvIndexValueElement = uvIndexWidget.querySelector('.uv-index-value');
            const uvIndexProtectionElement = uvIndexWidget.querySelector('.uv-index-protection');

            const fetchUVI = async () => {
                try {
                    // Coordinates for Phuket (e.g., Patong Beach)
                    const lat = 7.89;
                    const lon = 98.29;
                    const url = `https://api.openweathermap.org/data/2.5/uvi?lat=${lat}&lon=${lon}&appid=${UV_API_KEY}`;
                    const response = await fetch(url);
                    const data = await response.json();

                    if (response.ok) {
                        const uvIndex = data.value;
                        uvIndexValueElement.textContent = `UV Index: ${uvIndex}`;
                        let protectionAdvice = '';
                        if (uvIndex < 3) {
                            protectionAdvice = 'Low exposure. Little protection needed.';
                        } else if (uvIndex < 6) {
                            protectionAdvice = 'Moderate exposure. Seek shade, wear hat and sunglasses.';
                        } else if (uvIndex < 8) {
                            protectionAdvice = 'High exposure. Apply sunscreen, wear protective clothing.';
                        } else if (uvIndex < 11) {
                            protectionAdvice = 'Very High exposure. Minimize sun exposure during midday hours.';
                        } else {
                            protectionAdvice = 'Extreme exposure. Take all precautions, avoid sun exposure.';
                        }
                        uvIndexProtectionElement.textContent = protectionAdvice;
                    } else {
                        uvIndexProtectionElement.textContent = `Error: ${data.message}`;
                    }
                } catch (error) {
                    console.error('Failed to fetch UV Index data:', error);
                    uvIndexProtectionElement.textContent = 'Failed to load UV Index data.';
                }
            };
            fetchUVI(); // Initial fetch
            setInterval(fetchUVI, 60 * 60 * 1000 * 4); // Refresh every 4 hours
        } else if (uvIndexWidget && UV_API_KEY === 'YOUR_OPENWEATHERMAP_API_KEY') {
            uvIndexWidget.querySelector('.warning').textContent = 'Please replace YOUR_OPENWEATHERMAP_API_KEY with a valid API key for UV Index data.';
        }

        // --- Sun & Moon Widget Logic (using OpenWeatherMap One Call API for sunrise/sunset, and a simple lunar phase calculation) ---
        const SUNMOON_API_KEY = 'YOUR_OPENWEATHERMAP_API_KEY'; // Re-using OpenWeatherMap API key
        const sunMoonWidget = document.getElementById('sun-moon-widget');
        if (sunMoonWidget && SUNMOON_API_KEY !== 'YOUR_OPENWEATHERMAP_API_KEY') {
            const sunriseTimeElement = document.getElementById('sunrise-time');
            const sunsetTimeElement = document.getElementById('sunset-time');
            const moonriseTimeElement = document.getElementById('moonrise-time');
            const moonsetTimeElement = document.getElementById('moonset-time');
            const phaseIconElement = sunMoonWidget.querySelector('.phase-icon');
            const phaseInfoElement = sunMoonWidget.querySelector('.phase-info');

            const fetchSunMoonTimes = async () => {
                try {
                    const lat = 7.89; // Phuket latitude
                    const lon = 98.29; // Phuket longitude
                    // OpenWeatherMap One Call API for sunrise/sunset
                    const url = `https://api.openweathermap.org/data/3.0/onecall?lat=${lat}&lon=${lon}&exclude=minutely,hourly,daily,alerts&appid=${SUNMOON_API_KEY}&units=metric`;
                    const response = await fetch(url);
                    const data = await response.json();

                    if (response.ok) {
                        const { current } = data;
                        const sunrise = new Date(current.sunrise * 1000);
                        const sunset = new Date(current.sunset * 1000);

                        sunriseTimeElement.textContent = sunrise.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });
                        sunsetTimeElement.textContent = sunset.toLocaleTimeString('en-GB', { hour: '2-digit', minute: '2-digit' });

                        // Moon times are not directly available in current One Call API. For more accurate, a dedicated API is needed.
                        // Placeholder or simplified logic for moonrise/moonset if not using dedicated API:
                        // For a simple illustration, we can just say "unavailable" or estimate if a dedicated API is not used.
                        // For true accuracy, consider APIs like astronomical.alapi.net or timezonedb.com for moon times.
                        moonriseTimeElement.textContent = 'N/A'; // Replace with actual data if available
                        moonsetTimeElement.textContent = 'N/A';   // Replace with actual data if available

                        // Simplified Moon Phase Calculation (very basic, for illustration)
                        const now = new Date();
                        const startEpoch = new Date('2000-01-06T18:15:00Z'); // New moon epoch (Jan 6, 2000)
                        const msPerDay = 24 * 60 * 60 * 1000;
                        const synodicMonth = 29.53058867; // Days for one full lunar cycle

                        const daysSinceEpoch = (now.getTime() - startEpoch.getTime()) / msPerDay;
                        const currentPhaseDays = daysSinceEpoch % synodicMonth;

                        let phaseName = '';
                        let phaseIcon = ''; // Font Awesome moon icon
                        if (currentPhaseDays < 1.84566) {
                            phaseName = 'New Moon'; phaseIcon = 'üåë'; // Or specific FA icon
                        } else if (currentPhaseDays < 5.53699) {
                            phaseName = 'Waxing Crescent'; phaseIcon = 'üåí';
                        } else if (currentPhaseDays < 9.22831) {
                            phaseName = 'First Quarter'; phaseIcon = 'üåì';
                        } else if (currentPhaseDays < 12.91963) {
                            phaseName = 'Waxing Gibbous'; phaseIcon = 'üåî';
                        } else if (currentPhaseDays < 16.61096) {
                            phaseName = 'Full Moon'; phaseIcon = 'üåï';
                        } else if (currentPhaseDays < 20.30228) {
                            phaseName = 'Waning Gibbous'; phaseIcon = 'üåñ';
                        } else if (currentPhaseDays < 23.99361) {
                            phaseName = 'Last Quarter'; phaseIcon = 'üåó';
                        } else if (currentPhaseDays < 27.68493) {
                            phaseName = 'Waning Crescent'; phaseIcon = 'üåò';
                        } else {
                            phaseName = 'New Moon'; phaseIcon = 'üåë';
                        }
                        phaseInfoElement.textContent = phaseName;
                        phaseIconElement.textContent = phaseIcon; // Using emoji for simplicity, replace with FA if desired

                    } else {
                        console.error('Error fetching sun/moon data:', data.message);
                        // Display error in relevant elements
                    }
                } catch (error) {
                    console.error('Failed to fetch sun/moon data:', error);
                    // Display general error
                }
            };
            fetchSunMoonTimes();
            setInterval(fetchSunMoonTimes, 12 * 60 * 60 * 1000); // Refresh every 12 hours
        } else if (sunMoonWidget && SUNMOON_API_KEY === 'YOUR_OPENWEATHERMAP_API_KEY') {
            sunMoonWidget.querySelector('h4').textContent = 'Sun & Moon Times (API Key Missing)';
            sunMoonWidget.querySelector('.phase-info').textContent = 'Please replace YOUR_OPENWEATHERMAP_API_KEY with a valid API key.';
        }


        // üïê Live Local Time Script (Moved from dashboard snippet)
        function updateLocalTime() {
            const now = new Date();
            const options = { timeZone: 'Asia/Bangkok', hour: '2-digit', minute: '2-digit', second: '2-digit' };
            const localTimeElement = document.getElementById('localTime');
            if (localTimeElement) { // Ensure element exists before updating
                const timeString = now.toLocaleTimeString('en-GB', options);
                localTimeElement.textContent = `Current Local Time: ${timeString}`;
            }
        }
        setInterval(updateLocalTime, 1000);
        updateLocalTime(); // Initial call

        // üîÅ Auto-refresh all iframes every 15 minutes (Moved from dashboard snippet)
        setInterval(() => {
            document.querySelectorAll('.widget iframe').forEach(iframe => { // Target only dashboard iframes
                iframe.src = iframe.src;
            });
        }, 15 * 60 * 1000); // 15 minutes


        // Contact Form Submission (Basic)
        const contactForm = document.getElementById('contact-form');
        const formSuccess = document.querySelector('.form-success');
        if (contactForm) {
            contactForm.addEventListener('submit', function(e) {
                e.preventDefault(); // Prevent default form submission

                // In a real application, you would send this data to a server
                // For demonstration, we just show a success message
                formSuccess.style.display = 'block';
                contactForm.reset(); // Clear the form

                setTimeout(() => {
                    formSuccess.style.display = 'none';
                    // Optionally close the contact overlay after success
                    const contactSection = document.getElementById('contact');
                    if (contactSection) {
                        contactSection.classList.remove('active');
                        document.body.classList.remove('overlay-active');
                        // Restore home link active state
                        navLinkElements.forEach(l => l.classList.remove('active'));
                        const homeLink = document.querySelector('.nav-link[data-target="home"]');
                        if (homeLink) {
                            homeLink.classList.add('active');
                        }
                        if (homeContent) {
                            homeContent.classList.add('visible');
                        }
                    }
                }, 3000); // Hide success message after 3 seconds
            });
        }

        // Handle "Inquire Now" buttons to open Contact section
        document.querySelectorAll('.book-btn').forEach(btn => {
            btn.addEventListener('click', (e) => {
                e.preventDefault();
                // Close all other overlay sections
                contentSections.forEach(section => {
                    section.classList.remove('active');
                });
                // Open contact section
                const contactSection = document.getElementById('contact');
                if (contactSection) {
                    contactSection.classList.add('active');
                    document.body.classList.add('overlay-active');
                }
                // Hide home content
                if (homeContent) {
                    homeContent.classList.remove('visible');
                }
                // Update active nav link
                navLinkElements.forEach(l => l.classList.remove('active'));
                const contactLink = document.querySelector('.nav-link[data-target="contact"]');
                if (contactLink) {
                    contactLink.classList.add('active');
                }
            });
        });

    </script>
</body>
</html>
